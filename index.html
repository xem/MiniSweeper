<!-- blah blah -->
<style>
  body { width: 650px; margin: 20px auto; font-family: arial; }
  textarea { height: 170px; background: #def; padding: 5px; width: 650px; font-family: monospace; overflow: hidden; }
  a.fork { float: right; background: #def; padding: 10px; }
</style>
<a class=fork href=//github.com/xem/MiniSweeper>Fork me!</a>
<h1>MiniSweeper</h1>
<h2>A minesweeper in 575 bytes</h2>
<b>Golfed by <a href=//twitter.com/MaximeEuziere>xem</a></b>
<br>
<br>
<textarea>
&lt;table border id=t>&lt;script>s=10;b=[];f=[];n=[];v=[];g=0;function r(a,c,d){c&&(v[a]=1,b[a]&&g--);for(M=1;M;)for(M=0,H="",a=0;a&lt;s;a++)for(j=0;j&lt;s;j++){I=a*s+j;d&&(T=b[I]=0.1>Math.random());for(x=2;~x--;)for(y=2;~y--;)A=a+x,B=j+y,C=A*s+B,~A&&~B&&A&lt;s&&B&lt;s&&(s&&T&&(n[C]=-~n[C]),!c||v[I]||b[I]||!v[C]||n[C]||(v[I]=M=1));H+=(j?"":"&lt;tr>")+"&lt;td onclick=g||r("+I+",1) oncontextmenu=g||(f["+I+"]=!f["+I+"]);g=1;for(a=0;a&lt;s*s;a++)b[a]==!f[a]&&(g=0);r();return!1 align=center bgcolor="+(v[I]||g?"":"grey")+">"+(f[I]?"‚öë":b[I]&&g?"üí£":n[I]&&(v[I]||g)?n[I]:"‚ÄÅ‚ÄÇ")}t.innerHTML=H}r(0,0,1)&lt;/script>
<!-- 587 bytes / 575 with JScrush -->
</textarea>

<h2>Demo:</h2>
- Left click to reveal a cell and see how many bombs are around.
<br>
- Right click to set a flag where you believe there is a bomb.
<br>
- You lose if you reveal a bomb.
<br>
- You win when all the bombs are flagged.
<br>
<br>

<!-- Code golf -->

<table border id=t><script>_='s0;bfnvg;functi a,c,d){cv,bg--M;M;)M,H="",j;j<s;j++){I=a*s+j;dT=b.1>Math.random()xxyyA=a+x,B=j+y,C=A*s+B,~A~BA<sB<ssTn	=-~n	),!cb!v	n	(v=M)H+=(j<tr><td click=g,1) ctextmenu=g(=!g;s*b==!fgreturn!1 align=center bgcolor="+(ggrey>"+(f?"‚öë":bg?"üí£":ng)?n:"‚ÄÅ‚ÄÇ")}t.innerHTML=H}0,0,1)[I]fo&&=[];||"+I+"=0[a]	[C]);(s;a++)=1r(v?"":"a;a<on=2;~--;)")+"f[]';for(Y in $='	')with(_.split($[Y]))_=join(pop());eval(_)</script>

<!-- Original source code -->

<!--
<table border id=t>
<script>
s = 10; // Grid size
b = []; // Bombs
f = []; // Flags
n = []; // Neighbours
v = []; // Viewed
g = 0;  // Game over (-1: lost, 1: won)

// Render
// i: index
// L: left click
// S: start
function r(i,L,S){
  
  // Left click: view cell
  if(L){
    v[i]=1;
    
    // Bomb: game over
    if(b[i]){
      g--;
    }
  }

  // While there's more to show
  for(M=1;M;){
    
    // Assume there's nothing more to show
    M=0;
    
    // Reset HTML
    H="";
    
    // Loop on cells
    for(i=0;i<s;i++){
      for(j=0;j<s;j++){
        
        // Cell index
        I = i*s+j;
      
        // At start, set bomb randomly
        if(S){
          T=b[I]=Math.random()<.1;
        }

        // Loop on neighbours
        for(x=2;--x+2;){
          for(y=2;--y+2;){
          
            // Neighbour coordinates and index
            A=i+x;
            B=j+y;
            C=A*s+B;

            // If the neighbour is in bounds
            if(~A && ~B && A < s && B < s){
            
              // At start, if current cell has a bomb
              if(s && T){
              
                // Increment neighbour cell's counters
                n[C]=~~n[C]+1;
              }
            
              // On left click, if the current cell isn't visible and doesn't have a bomb, and the neighbour is visible and hasn't got neighbours
              if(L && !v[I] && !b[I] && v[C] && !n[C]){
                
                // Show current cell and assume there's more to show
                v[I]=M=1;
              }
            }
          }
        }
        
        // Fill HTML
        H+=(j?"":"<tr>")+"<td onclick=g||r("+I+",1) oncontextmenu=g||(f["+I+"]=!f["+I+"]);g=1;for(a=0;a<s*s;a++)b[a]==!f[a]&&(g=0);r();return!1 align=center bgcolor="+(v[I]||g?"white":"grey")+">"+(f[I]?"‚öë":((b[I]&&g)?"üí£":((n[I]&&(v[I]||g))?n[I]:"‚ÄÅ‚ÄÇ")));
      }
    }
  }
  
  // Write HTML in table
  t.innerHTML=H;
}
r(0,0,1)
</script>

-->